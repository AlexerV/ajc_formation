000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.    TP02.
000300 AUTHOR.        ALEXIS.
000400 INSTALLATION.  AJC.
000500 DATE-WRITTEN.  23/06/2025.
000600 DATE-COMPILED.
000700 SECURITY.      PROGRAMME COBOL TP02.
000800**************************************************
000900 ENVIRONMENT DIVISION.
001000 CONFIGURATION SECTION.
001100 SPECIAL-NAMES.
001200     DECIMAL-POINT IS COMMA.
001210
001300 INPUT-OUTPUT SECTION.
001400 FILE-CONTROL.
001500     SELECT EMPK ASSIGN FEMPK
001600     ORGANIZATION IS INDEXED
001601     ACCESS MODE IS RANDOM
001602     RECORD KEY IS CODE-EMPK
001603     FILE STATUS IS FS-EMPK.
001606
001610**************************************************
001700 DATA DIVISION.
001701 FILE SECTION.
001702 FD EMPK.
001703 01 ENR-EMPK.
001704    05 CODE-EMPK  PIC X(5).
001705    05 NOM-EMPK   PIC X(15).
001706    05 PREN-EMPK  PIC X(15).
001707    05 CP-EMPK    PIC X(5).
001708    05 VILLE-EMPK PIC X(20).
001709    05 SALAIRE-EMPK PIC 9(7).
001710    05 FILLER PIC X(3).
001711
001712 WORKING-STORAGE SECTION.
001713 77 FS-EMPK PIC 99.
001714 77 WS-ANO PIC 9 VALUE ZERO.
001715 77 WS-CONCAT PIC X(53) VALUE ALL SPACES.
001716* 15+1+15+7+9+6
001735**************************************************
001750 PROCEDURE DIVISION.
001770     OPEN INPUT EMPK
001771     IF FS-EMPK NOT EQUAL ZERO THEN
001772          DISPLAY 'ERREUR OPEN EMPK ! FS-EMPK : ' FS-EMPK
001773          PERFORM ABEND-PROG
001774     END-IF
001775
001776     MOVE '45003' TO CODE-EMPK
001777     READ EMPK
001787     EVALUATE FS-EMPK
001788       WHEN ZERO
001789           DISPLAY 'NOM EMPLOYE : ' NOM-EMPK
001790           PERFORM AFF-EMP
001791       WHEN 23
001792         DISPLAY CODE-EMPK ' EST INTROUVABLE'
001793       WHEN OTHER
001794         DISPLAY 'ERR READ EMPK : ' FS-EMPK
001795         PERFORM ABEND-PROG
001796     END-EVALUATE
001800
001801     CLOSE EMPK
001802     IF FS-EMPK NOT EQUAL ZERO THEN
001803         DISPLAY 'ERREUR CLOSE EMPK ! FS-EMPK : ' FS-EMPK
001804         PERFORM ABEND-PROG
001805     END-IF
001806
001807     STOP RUN.
001808
001812 AFF-EMP.
001813     MOVE SPACE TO WS-CONCAT
001814     STRING
001815        PREN-EMPK DELIMITED BY '  '
001816        SPACE DELIMITED BY SIZE
001817        NOM-EMPK DELIMITED BY '  '
001818        ' GAGNE ' DELIMITED BY SIZE
001819        SALAIRE-EMPK DELIMITED BY SIZE
001820        ' EUROS' DELIMITED BY SIZE
001821        INTO WS-CONCAT
001822        ON OVERFLOW
001823           DISPLAY 'ZONE RESULTAT TROP PETITE'
001824     END-STRING
001830     DISPLAY WS-CONCAT.
001831
001840 ABEND-PROG.
001850     DISPLAY '---- ABEND PROG ----'
001860     COMPUTE WS-ANO = 1 / WS-ANO.
